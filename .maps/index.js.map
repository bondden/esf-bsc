{"version":3,"sources":["index.es7.js"],"names":[],"mappings":"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","file":"index.es7.js","sourcesContent":["/**\n * Created by Denis Bondarenko <bond.den@gmail.com> on 01.08.2015.\n */\n\"use strict\";\n\nvar\n  fs       =require('fs-extra'),\n  path     =require('path'),\n  parentSrc=require('parent-search')\n  ;\n\nimport * as modUtl from 'esf-utl';\n\nvar\n  U=modUtl.Utl,\n  L=U.log,\n  E=U.rejectingError\n  ;\n\n/**\n * abstract class\n */\nexport class Bsc {\n\n  constructor(){\n    this.cfg   =null;\n    this.cfgPth='tst/d/esfapp.cfg.json';\n  }\n\n  /**\n   * [[Description]]\n   * @returns {Promise} [[Description]]\n   */\n  loadConfig(){\n\n    var H=this;\n    if(H.cfg){\n      return new Promise((rs,rj)=>{\n        L('Bsc: Using preset cfg: '+JSON.stringify(H.cfg,null,'\\t'));\n        rs(H.cfg);\n      });\n    }\n\n    return new Promise((rs,rj)=>{\n\n      L('Searching .esfrc starting from : `'+__dirname+'`...');\n\n      parentSrc(__dirname,'.esfrc',{},(e0,esfrcPth)=>{\n\n        if(e0){\n          return E(3,'.esfrc search error',e0,rj);\n        }\n\n        if(!esfrcPth){\n          let msg='.esfrc not found';\n          return E(3,msg,new Error(msg),rj);\n        }\n\n        L('.esfrc found at : '+esfrcPth);\n\n        let esfrcPath=path.resolve(esfrcPth);\n        L('Getting cfgPth from : `'+esfrcPath+'`...');\n        fs.readJson(esfrcPath,(e,r)=>{\n\n          if(e){\n            return E(1,'.esfrc reading error',e,rj);\n          }\n\n          if(typeof r.cfgPth==='string'){\n            H.cfgPth=r.cfgPth;\n          }\n\n          if(!path.isAbsolute(H.cfgPth)){\n            H.cfgPth=path.resolve(path.dirname(esfrcPth)+'/'+H.cfgPth);\n          }\n\n          L('Using cfgPath: '+H.cfgPth);\n\n          fs.readJson(path.resolve(H.cfgPth),(e1,cfg)=>{\n\n            if(e1){\n              return E(2,'Error reading '+H.cfgPth,e1,rj);\n            }\n\n            H.cfg=cfg;\n            rs(H.cfg);\n\n          });\n\n        });\n\n      });\n\n    });\n\n  }\n\n  reloadConfig(pathToConfigFile=null){\n    var H=this;\n    return new Promise((rs,rj)=>{\n\n      if(pathToConfigFile){\n        H.cfgPth=pathToConfigFile;\n      }\n\n      H.loadConfig()\n       .then(r=>{\n         rs(r);\n       })\n       .catch(e=>{\n         return E(3,'Error reloading config from: '+H.cfgPth,e,rj);\n       })\n      ;\n\n    });\n  }\n\n}\n"],"sourceRoot":"/source/"}