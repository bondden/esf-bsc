{"version":3,"sources":["index.es7.js"],"names":[],"mappings":"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","file":"index.es7.js","sourcesContent":["/**\n * Created by Denis Bondarenko <bond.den@gmail.com> on 01.08.2015.\n */\n\"use strict\";\n\nvar\n  fs       =require('fs-extra'),\n  path     =require('path'),\n  parentSrc=require('parent-search')\n  ;\n\nimport * as modUtl from 'esf-utl';\n\nvar\n  U=modUtl.Utl,\n  L=U.log,\n  E=U.rejectingError\n  ;\n\n/**\n * abstract class\n */\nexport class Bsc {\n\n  constructor(){\n    this.cfg   =null;\n    this.cfgPth='tst/d/esfapp.cfg.json';\n  }\n\n  /**\n   * [[Description]]\n   * @returns {Promise} [[Description]]\n   */\n  loadConfig(){\n\n    var H=this;\n    if(H.cfg){\n      return new Promise((rs,rj)=>{\n        L('Bsc: Using preset cfg: '+JSON.stringify(H.cfg,null,'\\t'));\n        rs(H.cfg);\n      });\n    }\n\n    return new Promise((rs,rj)=>{\n\n      L('Searching .esfrc starting from : `'+__dirname+'`...');\n\n      parentSrc(__dirname,'.esfrc',{},(e0,esfrcPth)=>{\n\n        if(e0){\n          return E(3,'.esfrc search error',e0,rj);\n        }\n\n        if(!esfrcPth){\n          let msg='.esfrc not found';\n          return E(3,msg,new Error(msg),rj);\n        }\n\n        L('.esfrc found at : '+esfrcPth);\n\n        let esfrcPath=path.resolve(esfrcPth);\n        L('Getting cfgPth from : `'+esfrcPath+'`...');\n        fs.readJson(esfrcPath,(e,r)=>{\n\n          if(e){\n            return E(1,'.esfrc reading error',e,rj);\n          }\n\n          if(typeof r.cfgPth==='string'){\n            H.cfgPth=r.cfgPth;\n          }\n\n          if(!path.isAbsolute(H.cfgPth)){\n            H.cfgPth=path.resolve(path.dirname(esfrcPth)+'/'+H.cfgPth);\n          }\n\n          L('Using cfgPath: '+H.cfgPth);\n\n          fs.readJson(path.resolve(H.cfgPth),(e1,cfg)=>{\n\n            if(e1){\n              return E(2,'Error reading '+H.cfgPth,e1,rj);\n            }\n\n            H.cfg=cfg;\n            rs(H.cfg);\n\n          });\n\n        });\n\n      });\n\n    });\n\n  }\n\n  reloadConfig(pathToConfigFile=null){\n    var H=this;\n    return new Promise((rs,rj)=>{\n\n      if(pathToConfigFile){\n        H.cfgPth=pathToConfigFile;\n      }\n\n      H.loadConfig().then((r)=>{\n        rs(r);\n      }).catch((e)=>{\n        return E(3,'Error reloading config from: '+H.cfgPth,e,rj);\n      });\n\n    });\n  }\n\n}\n"],"sourceRoot":"/source/"}